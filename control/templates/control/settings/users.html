{% extends 'base.html' %}
{% load static %}

{% load crispy_forms_tags %}


{% block head %}
  <script src="{% static 'js/highcharts.js' %}"></script>
  <link rel="stylesheet" type="text/css" href="{% static 'css/jquery.dataTables.min.css' %}" />
  <script src="{% static 'js/jquery.dataTables.min.js' %}"></script>
{% endblock %}


{% block body %}
<div class="container">
  <h3>Настройки пользователей</h3>
  <ul class="nav nav-tabs">
    <li class="nav-item">
    <a class="nav-link" href="{% url 'settings_dashboard' %}">Статистика системы</a>
    </li>
    <li class="nav-item active">
      <a class="nav-link" href="{% url 'settings_users' %}">Пользователи</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="{% url 'settings_groups' %}">Группы</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="{% url 'settings_courses' %}">Курсы</a>
    </li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane fade show active" id="users">
      <br/>
      <div class="text-right"><td><a href="{% url 'user_add' %}" class="btn btn-primary">Создать</a></td></div>
      <br/>
      <table id="user-table" class="table table-striped table-bordered sortable">
        <thead>
          <tr>
            <th class="th-sm">ФИО</th>
            <th class="th-sm">Ученик</th>
            <th class="th-sm">Последнее посещение</th>
            <th class="th-sm">Текущие курсы</th>
            <th class="th-sm">Редактировать профиль пользователя</th>
            <th class="th-sm">Удалить пользователя</th>
          </tr>
        </thead>
        <tbody>
        {% for user in users %}
          <tr>
            <td>{{ user.last_name }} {{ user.first_name }} {{ user.profile.patronymic }}</td>
            <td>{% if user.is_staff %} Нет {% else %} Да {% endif %}</td>
            <td>{{ user.last_login }}</td>
            <td>{% for group in user.group.all %}{{ group.course }} {% endfor %}</td>
            <td><a href="{% url 'user_edit' pk=user.pk %}">Редактировать</a></td>
            <td>
              <form action="{% url 'user_del' pk=user.pk %}" method="post">
                  {% csrf_token %}
                  <button type="submit" href="">Удалить </button>
              </form>
            </td>
          </tr>
        {% endfor %}
        </tbody>
        <tfoot>
          <tr>
            <th class="th-sm">ФИО</th>
            <th class="th-sm">Ученик</th>
            <th class="th-sm">Последнее посещение</th>
            <th class="th-sm">Текущие курсы</th>
            <th class="th-sm">Редактировать</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>
{% endblock %}

